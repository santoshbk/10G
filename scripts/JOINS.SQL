/* 
JOINS
----------
  > TO SELECT DATA FROM MULTIPLE TABLES
  
  oRACLE PROP. SYNTAX                         =>  SQL-99 SYNTAX
  ==========================================================================
  > EQUI                                        > INNER JOIN
  > OUTER                                       > OUTER(LEFT, RIGHT, FULL)
  > NON EQUI                                    > JOIN
  > CARTESIAN                                   > CROSS JOIN
  > SELF                                        > JOIN (SAME TABLE)
                                                > NATURAL   
                                                > USING
RULES:
-------------------------------------------
 > COLUMNS SHOULD HAVE THE FORMAT
    E.ENAME OR EMP.ENAME
 > TYPE OF JOIN SHOULD BE SPECIFIED
 > JOIN CONDITION USES ON CLAUSE
 
 EQUI(INNER) JOIN:
 ----------------------
 > JOIN CONDITION USES = OPERATOR
 > TABLES HAVING REFERENTIAL INTEGRITY -> PARENT CHILD RELATION
 > WORKS LIKE ITERSECTS - COMMON TO BOTH TABLES
 
 OUTER JOINS: = INNER JOIN + MISSING DATA
 ----------------------------------------
  LEFT = INNER JOIN + MISSING DATA FROM LEFT TABLE
  RIGHT = INNER JOIN + MISSING DATA FROM RIGHT TABLE
  FULL = MISSING DATA IN BOTH TABLE
*/

-- DISPLAY DNAME FOR EACH ENAME
SELECT E.ENAME, D.DNAME
FROM EMP E INNER JOIN DEPT D
ON E.DEPTNO = D.DEPTNO
ORDER BY D.DNAME;

SELECT SUM(SAL), D.DNAME
FROM EMP E INNER JOIN DEPT D
ON E.DEPTNO = D.DEPTNO
GROUP BY D.DNAME
ORDER BY 1;

-- FIND EMP WORKING IN CHICAGO AS CLERK
SELECT * FROM DEPT;

SELECT E.ENAME, D.LOC, E.JOB
FROM EMP E INNER JOIN DEPT D
ON E.DEPTNO = D.DEPTNO
AND D.LOC = 'CHICAGO'
AND E.JOB='CLERK';

SELECT E.ENAME, D.LOC, E.JOB
FROM EMP E INNER JOIN DEPT D
ON E.DEPTNO = D.DEPTNO
WHERE D.LOC = 'CHICAGO'
AND E.JOB='CLERK';

-- DISPLAY ENAME, DNAME ALONG WITH DNAME WHERE NO EMP ARE WORKING
SELECT E.ENAME, D.DNAME
FROM EMP E RIGHT OUTER JOIN DEPT D
ON E.DEPTNO = D.DEPTNO
ORDER BY 1;

INSERT INTO EMP(EMPNO, ENAME) VALUES(6666,'XYZ');
COMMIT;
SELECT E.ENAME, D.DNAME
FROM EMP E LEFT OUTER JOIN DEPT D
ON E.DEPTNO = D.DEPTNO
ORDER BY 1;

SELECT E.ENAME, D.DNAME
FROM EMP E FULL OUTER JOIN DEPT D
ON E.DEPTNO = D.DEPTNO
ORDER BY 1;
